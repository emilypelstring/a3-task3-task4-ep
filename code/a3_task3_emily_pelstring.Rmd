---
title: "a3_task3_emily_pelstring"
author: "Emily Pelstring"
date: "10/27/2021"
output: html_document
---

**Data:** Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b. 

Explanation: To be added later. 

## Set Up 

Read in the packages that are needed. 

```{r setup, include=TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(lubridate)
library(janitor)
library(kableExtra)
```

## Read in the Data 

Reading in the urchin data. 

```{r}
urchins <- read_csv(here("data","urchins.csv"))
```

## Cleaning Up Data 

Applying clean_names to the urchin data set. 

```{r}
urchins_clean <- urchins %>%
  clean_names() #clean names is in the janitor package
```

## Data Visualization

Here we utilize a histogram plot to visualize the different sizes of urchins, separated into species. 

```{r}
ggplot(data = urchins_clean, #selecting the data
       aes(x = size)) + #making the x axis based on size 
  geom_histogram(bins = 10) + #changing bins from 30 to 10
  facet_wrap(~ common_name) + #separating out species 
  theme_minimal() +
  labs(x = "Size of Urchin (in cm)",
       y = "number of Sea Urchins",
       title = "Size of Sea Urchins (PELSTRING)")
```
Figure #1: **Size of Sea Urchins by Species.** Sea urchin size was recorded for two different species, the Red Sea Urchin and the Purple Sea Urchin. The number of sea urchins at each corresponding size is represented by the height of the histogram bars, with measured size of the sea urchin on x-axis in centimeters (cm). 

## Descriptive Statistics Table

```{r}
urchin_statistics <- urchins_clean %>% #selecting the data
  group_by(common_name) %>% #grouping by species/common name
  summarize(mean_size_cm = round(mean(size, na.rm = TRUE), 1), #finding the mean, rounding to 1 decimal place
            median_size_cm = round(median(size, na.rm = TRUE), 1), #finding the median, rounding to 1 decimal place
            sd_size_cm = round(sd(size, na.rm = TRUE), 1), #finding the sd, rounding to 1 decimal place
            sample_size = n()) #adding sample size 

urchin_statistics %>% #creating a table for the HTML doc 
  kable(col.names = c("Common Name", #adding column names 
                      "Mean Size (cm)",
                      "Median Size (cm)",
                      "Standard Deviation (cm)",
                      "Sample Size")) %>%
  kable_styling(full_width = FALSE) #styling preference 
```

Figure #2: **Mean, Median, SD, and Sample Size of Sea Urchin Size by Species**: Sea urchin size was recorded (in cm) for two species, Red Sea Urchins (n = 27408) and Purple Sea Urchins (n = 31805). The mean Red Sea Urchin size is 6.8 cm $\pm$ 1.9 cm, while the mean Purple Sea Urchin size is 4.5 cm $\pm$ 1.2 cm. The median Red Sea Urchin size is 7.0 cm, and the median Purple Sea Urchin size is 4.5 cm.

### Summary of Data 

Both the Red Sea Urchin and Purple Sea Urchin size (in cm) is normally distributed in the histogram graph. The Red Sea Urchin mean size is 2.3 cm higher than the mean size of Purple Sea Urchin. The mean size of the Red Sea Urchin is 33.8% higher than the mean size of the Purple Sea Urchin, while the standard deviations are 0.7 cm apart. In general, the size of Red Sea Urchins is higher than the size of Purple Sea Urchins in this sample population. 

## Exploring Purple Urchin Count by Site and Year 

```{r}
purple_urchins <- urchins_clean %>%
  filter(common_name == "Purple Urchin") %>%
  mutate(date_new = ymd(date)) %>%
  mutate(year_new = year(date_new)) %>%
  mutate(site_full = case_when(
    site %in% c("NAPL") ~ "Naples Reef",
    site %in% c("AQUE") ~ "Arroyo Quemado Reef",
    site %in% c("CARP") ~ "Carpinteria Reef",
    site %in% c("MOHK") ~ "Mohawk Reef",
    site %in% c("IVEE") ~ "Isla Vista Reef"))
```


